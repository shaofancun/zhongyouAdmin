<!DOCTYPE html>
<!-- 
Template Name: Metronic - Responsive Admin Dashboard Template build with Twitter Bootstrap 3.3.2
Version: 3.6.2
Author: KeenThemes
Website: http://www.keenthemes.com/
Contact: support@keenthemes.com
Follow: www.twitter.com/keenthemes
Like: www.facebook.com/keenthemes
Purchase: http://themeforest.net/item/metronic-responsive-admin-dashboard-template/4021469?ref=keenthemes
License: You must have a valid license purchased only from themeforest(the above link) in order to legally use the theme for your project.
-->
<!--[if IE 8]> <html lang="en" class="ie8 no-js"> <![endif]-->
<!--[if IE 9]> <html lang="en" class="ie9 no-js"> <![endif]-->
<!--[if !IE]><!-->
<html lang="en" class="no-js">
<!--<![endif]-->
<!-- BEGIN HEAD -->
<head>
<meta charset="utf-8"/>
<title>后台管理系统</title>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="" name="description"/>
<meta content="" name="author"/>
<!-- BEGIN GLOBAL MANDATORY STYLES -->
<link href="../static/style/default/mix/metronic3.6/theme/assets/global/plugins/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css"/>
<link href="../static/style/default/mix/metronic3.6/theme/assets/global/plugins/simple-line-icons/simple-line-icons.min.css" rel="stylesheet" type="text/css"/>
<link href="../static/style/default/mix/metronic3.6/theme/assets/global/plugins/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="../static/style/default/mix/metronic3.6/theme/assets/global/plugins/uniform/css/uniform.default.css" rel="stylesheet" type="text/css"/>
<link href="../static/style/default/mix/metronic3.6/theme/assets/global/plugins/bootstrap-switch/css/bootstrap-switch.min.css" rel="stylesheet" type="text/css"/>
<!-- END GLOBAL MANDATORY STYLES -->
<!-- BEGIN PAGE LEVEL PLUGIN STYLES -->
<link href="../static/style/default/mix/metronic3.6/theme/assets/global/plugins/bootstrap-daterangepicker/daterangepicker-bs3.css" rel="stylesheet" type="text/css"/>
<link href="../static/style/default/mix/metronic3.6/theme/assets/global/plugins/fullcalendar/fullcalendar.min.css" rel="stylesheet" type="text/css"/>
<link href="../static/style/default/mix/metronic3.6/theme/assets/global/plugins/jqvmap/jqvmap/jqvmap.css" rel="stylesheet" type="text/css"/>
<!-- END PAGE LEVEL PLUGIN STYLES -->
<!-- BEGIN PAGE STYLES -->
<link href="../static/style/default/mix/metronic3.6/theme/assets/admin/pages/css/tasks.css" rel="stylesheet" type="text/css"/>
<!-- END PAGE STYLES -->
<!-- BEGIN THEME STYLES -->
<!-- DOC: To use 'rounded corners' style just load 'components-rounded.css' stylesheet instead of 'components.css' in the below style tag -->
<link href="../static/style/default/mix/metronic3.6/theme/assets/global/css/components.css" id="style_components" rel="stylesheet" type="text/css"/>
<link href="../static/style/default/mix/metronic3.6/theme/assets/global/css/plugins.css" rel="stylesheet" type="text/css"/>
<link href="../static/style/default/mix/metronic3.6/theme/assets/admin/layout/css/layout.css" rel="stylesheet" type="text/css"/>
<link href="../static/style/default/mix/metronic3.6/theme/assets/admin/layout/css/themes/darkblue.css" rel="stylesheet" type="text/css" id="style_color"/>
<link href="../static/style/default/mix/metronic3.6/theme/assets/admin/layout/css/custom.css" rel="stylesheet" type="text/css"/>
<!-- END THEME STYLES -->
<link rel="shortcut icon" href="favicon.ico"/>

<body class="page-header-fixed page-quick-sidebar-over-content page-style-square">
<!-- BEGIN HEADER -->
<div class="page-header navbar navbar-fixed-top">
	<!-- BEGIN HEADER INNER -->
	<div class="page-header-inner">
		<div class="page-logo">
			<a href="index.html"><img src="../static/style/default/mix/metronic3.6/theme/assets/admin/layout/img/logo.png" alt="logo" class="logo-default"></a>
			<div class="menu-toggler sidebar-toggler"></div>
		</div>
		<div class="hor-menu hor-menu-light hidden-sm hidden-xs">
			<ul class="nav navbar-nav">
				<li class="classic-menu-dropdown"><a href="../index.html">首页</a></li>
				<li class="classic-menu-dropdown"><a href="../finance/detailsList.html">财务</a></li>
				<li class="classic-menu-dropdown"><a href="../statistics/orderSales.html">统计</a></li>
				<li class="classic-menu-dropdown active"><a href="../vote/voteList.html">营销<span class="selected"></span></a></li>
			</ul>
		</div>
	</div>
	<!-- END HEADER INNER -->
</div>
<!-- END HEADER -->
<div class="clearfix">
</div>
<!-- container -->
<div class="page-container">
	<!--左侧列表 -->
	<div class="page-sidebar-wrapper">
		<div class="page-sidebar navbar-collapse collapse">
			<ul class="page-sidebar-menu" data-keep-expanded="false" data-auto-scroll="true" data-slide-speed="200">
				<!-- DOC: To remove the search box from the sidebar you just need to completely remove the below "sidebar-search-wrapper" LI element -->
				<li class="sidebar-search-wrapper">
					<!-- BEGIN RESPONSIVE QUICK SEARCH FORM -->
					<!-- DOC: Apply "sidebar-search-bordered" class the below search form to have bordered search box -->
					<!-- DOC: Apply "sidebar-search-bordered sidebar-search-solid" class the below search form to have bordered & solid search box -->
					<form class="sidebar-search " action="extra_search.html" method="POST">
						<a href="javascript:;" class="remove"><i class="icon-close"></i></a>
						<div class="input-group">
							<input type="text" class="form-control" placeholder="Search...">
							<span class="input-group-btn"><a href="javascript:;" class="btn submit"><i class="icon-magnifier"></i></a></span>
						</div>
					</form>
					<!-- END RESPONSIVE QUICK SEARCH FORM -->
				</li>
				<li>
					<a href="javascript:;"><i class="fa fa-credit-card "></i><span class="title">投票</span><span class="selected"></span><span class="arrow"></span></a>
					<ul class="sub-menu">
						<li><a href="../vote/voteList.html">投票列表</a></li>
						<li><a href="../vote/voteAdd.html">新增投票</a></li>
					</ul>
				</li>
				<li class="active open">
					<a href="javascript:;"><i class="fa fa-credit-card "></i><span class="title">刮刮卡</span><span class="selected"></span><span class="arrow"></span></a>
					<ul class="sub-menu">
						<li class="active"><a href="lotteryList.html">刮刮卡列表</a></li>
					</ul>
				</li>
			</ul>
		</div>
	</div>
	<!-- 左侧列表 /-->
	<!--content-wrapper-->
	<div class="page-content-wrapper">
		<div class="page-content" style="min-height:812px">
			<!--标题栏-->
			<h3 class="page-title">添加刮刮卡 <small>添加一个新的刮刮卡</small></h3>
			<!--路径导航-->
			<div class="page-bar">
				<ul class="page-breadcrumb">
					<li><i class="fa fa-home"></i><a href="#">首页</a><i class="fa fa-angle-right"></i></li>
					<li><a href="#">营销</a><i class="fa fa-angle-right"></i></li>
					<li><a href="#">刮刮卡列表</a><i class="fa fa-angle-right"></i></li>
					<li><a href="#">新增</a></li>
				</ul>
			</div>
			<!--表单-->
			<div class="row">
				<div class="col-md-12">
					<form action="" class="form-horizontal form-row-seperated" method="post">
						<div class="portlet">
							<div class="portlet-title">
								<div class="caption">
									<i class="fa fa-edit"></i>内容设置
								</div>
								<div class="pull-right">
									<a href="lotteryList.html" class="btn default"><i class="fa fa-angle-left"></i> 返回</a>
									<button type="reset" class="btn default"><i class="fa fa-refresh"></i> 重置</button>
									<button type="submit" class="btn green"><i class="fa fa-check-circle"></i> 保存</button>
								</div>
							</div>
						</div>
						<div class="portlet-body form">
							<div class="tab-content">
								<div class="form-body">
									<div class="form-group">
										<label class="control-label col-md-2">名称 <span class="required" aria-required="true">*</span></label>
										<div class="col-md-4"><input type="text" class="form-control" name="name" placeholder="请输入活动名称，不超过20个字"></div>
									</div>
									<div class="form-group">
										<label class="control-label col-md-2">奖项设置 <span class="required" aria-required="true">*</span></label>
										<div class="col-md-10">
											<div class="dataTables_wrapper no-footer" id="sample_1_wrapper">
												<div class="table-scrollable">
													<table class="table table-bordered table-hover dataTable no-footer" id="sample_1" role="grid" aria-describedby="sample_1_info">
														<thead>
															<tr role="row">
																<th width="200">奖项名称</th>
																<th width="200">图片</th>
																<th width="100">图片预览</th>
																<th width="200">奖项内容</th>
																<th width="100">数量</th>
																<th>操作</th>
															</tr>
														</thead>
														<tbody id="tbody">

														</tbody>
													</table>
												</div>
											</div>
											<a href="javascript:;" class="btn btn-default" id="addTr"><i class="fa fa-plus"></i> 添加奖项</a>
										</div>
									</div>
									<div class="form-group">
										<label class="control-label col-md-2">活动时间 <span class="required" aria-required="true">*</span></label>
										<div class="col-md-4">
											<div data-date-format="yyyy-mm-dd" class="input-group input-large date-picker input-daterange">
												<input type="text" name="begin_time" class="form-control" value="" placeholder="开始时间">
												<span class="input-group-addon">至</span>
												<input type="text" name="end_time" class="form-control" value="" placeholder="结束时间">
											</div>
										</div>
									</div>
									<div class="form-group">
										<label class="control-label col-md-2">抽奖条件 <span class="required" aria-required="true">*</span></label>
										<div class="col-md-4">
											<input type="text" class="form-control" name="moeny" value="" id="money">
											<span class="help-block">每支付 <span class="text-danger">0</span> 元，获得1次抽奖机会</span>
										</div>
									</div>
									<div class="form-group">
										<label class="control-label col-md-2">奖品总数 <span class="required" aria-required="true">*</span></label>
										<div class="col-md-4">
											<input type="text" class="form-control" name="number" value="" id="number">
										</div>
									</div>
								</div>
							</div>
						</div>
					</form>
				</div>
			</div>
			<!--表单 /-->
		</div>
	</div>
	<!--content-wrapper /-->
</div>
<!-- container /-->
<!-- BEGIN FOOTER -->
<div class="page-footer">
	<div class="page-footer-inner"> 2014 &copy; Metronic by keenthemes.</div>
	<div class="scroll-to-top">
		<i class="icon-arrow-up"></i>
	</div>
</div>
<!-- END FOOTER -->

<!-- BEGIN JAVASCRIPTS(Load javascripts at bottom, this will reduce page load time) -->
<!-- BEGIN CORE PLUGINS -->
<!--[if lt IE 9]>
<script src="../static/style/default/mix/metronic3.6/theme/assets/global/plugins/respond.min.js"></script>
<script src="../static/style/default/mix/metronic3.6/theme/assets/global/plugins/excanvas.min.js"></script> 
<![endif]-->
<script src="../static/style/default/mix/metronic3.6/theme/assets/global/plugins/jquery.min.js" type="text/javascript"></script>
<script src="../static/style/default/mix/metronic3.6/theme/assets/global/plugins/jquery-migrate.min.js" type="text/javascript"></script>
<!-- IMPORTANT! Load jquery-ui.min.js before bootstrap.min.js to fix bootstrap tooltip conflict with jquery ui tooltip -->
<script src="../static/style/default/mix/metronic3.6/theme/assets/global/plugins/jquery-ui/jquery-ui.min.js" type="text/javascript"></script>
<script src="../static/style/default/mix/metronic3.6/theme/assets/global/plugins/bootstrap/js/bootstrap.min.js" type="text/javascript"></script>
<script src="../static/style/default/mix/metronic3.6/theme/assets/global/plugins/bootstrap-hover-dropdown/bootstrap-hover-dropdown.min.js" type="text/javascript"></script>
<script src="../static/style/default/mix/metronic3.6/theme/assets/global/plugins/jquery-slimscroll/jquery.slimscroll.min.js" type="text/javascript"></script>
<script src="../static/style/default/mix/metronic3.6/theme/assets/global/plugins/jquery.blockui.min.js" type="text/javascript"></script>
<script src="../static/style/default/mix/metronic3.6/theme/assets/global/plugins/jquery.cokie.min.js" type="text/javascript"></script>
<script src="../static/style/default/mix/metronic3.6/theme/assets/global/plugins/uniform/jquery.uniform.min.js" type="text/javascript"></script>
<script src="../static/style/default/mix/metronic3.6/theme/assets/global/plugins/bootstrap-switch/js/bootstrap-switch.min.js" type="text/javascript"></script>
<!-- END CORE PLUGINS -->
<!-- BEGIN PAGE LEVEL PLUGINS -->
<script type="text/javascript" src="../static/style/default/mix/metronic3.6/theme/assets/global/plugins/select2/select2.min.js"></script>
<script type="text/javascript" src="../static/style/default/mix/metronic3.6/theme/assets/global/plugins/bootstrap-datepicker/js/bootstrap-datepicker.js"></script>
<!-- END PAGE LEVEL PLUGINS -->
<!-- BEGIN PAGE LEVEL SCRIPTS -->
<script src="../static/style/default/mix/metronic3.6/theme/assets/global/scripts/metronic.js" type="text/javascript"></script>
<script src="../static/style/default/mix/metronic3.6/theme/assets/admin/layout/scripts/layout.js" type="text/javascript"></script>
<script src="../static/style/default/mix/metronic3.6/theme/assets/admin/layout/scripts/quick-sidebar.js" type="text/javascript"></script>
<script src="../static/style/default/mix/metronic3.6/theme/assets/admin/layout/scripts/demo.js" type="text/javascript"></script>
<!-- END PAGE LEVEL SCRIPTS -->
<!-- 上传图片 -->

<div id="image_uploader" class="modal fade">
		<div class="modal-dialog">
				<div class="modal-content">
						<div class="modal-header">
								<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
								<h4 class="modal-title">上传图片</h4>
						</div>
						
						<div class="modal-body">
										<script type="text/javascript" src="../static/style/default/js/lib/plupload/plupload.full.min.js"></script>
										<script type="text/javascript" src="../static/style/default/js/lib/jquery.cookie.js"></script>
										<script type="text/javascript">
										function ImageUploader() {
											this.callback = '';
											this.uploader = new plupload.Uploader({
												runtimes : 'html5,flash,silverlight,html4',
												browse_button : 'pickfiles', // you can pass in id...
												container: document.getElementById('image_uploader_container'), // ... or DOM Element itself
												//url : '/imageuc/image/upload',
												url : 'http://192.168.1.250/zzb_wap/testApi/upimg.php',
												flash_swf_url : '/static/style/default/js/lib/plupload/Moxie.swf',
												silverlight_xap_url : '/static/style/default/js/lib/plupload/Moxie.xap',
												file_data_name : 'image',
												multi_selection : false, // 暂时取消批量上传
												
												filters : {
													max_file_size : '10mb',
													file_size : '1mb',
													mime_types : [
														{ title : "Image files", extensions : "jpg,gif,png"}
													]
												},
												
												multipart_params: {
													'cookie' : $.cookie('session_id'),
													'from' : ''
												},
											
												init: {
													PostInit: function() {
														document.getElementById('filelist').innerHTML = '';
													},
													
													FileUploaded: function(uploader,file,responseObject) {
														imageUploader.ret(responseObject);
													},
											
													FilesAdded: function(up, files) {
														plupload.each(files, function(file) {
															document.getElementById('filelist').innerHTML += '<div id="' + file.id + '">' + file.name + ' (' + plupload.formatSize(file.size) + ') <b></b></div>';
														});
														
														imageUploader.uploader.start();
													},
											
													UploadProgress: function(up, file) {
														document.getElementById(file.id).getElementsByTagName('b')[0].innerHTML = '<span>' + file.percent + "%</span>";
													},
											
													Error: function(up, err) {
														document.getElementById('console').innerHTML += "\nError #" + err.code + ": " + err.message;
													}
												}
											});
											
											this.uploader.init();
										}
										
										ImageUploader.prototype.show = function(from,callback,dom) {
											$('#image_uploader').show();
											this.uploader.settings.multipart_params.from = from;
											this.setCallback(callback);
										}
										
										ImageUploader.prototype.close = function() {
											$('#image_uploader').find('#filelist').html('').end().hide();
										}
										
										ImageUploader.prototype.setCallback = function(callback) {
											this.callback = callback;
										}
										
										ImageUploader.prototype.ret = function(responseObject) {
											this.close();
											this.callback(responseObject);
										}
										</script>
										
										<div id="filelist">Your browser doesn't have Flash, Silverlight or HTML5 support.</div>
										<br />
										
										<div id="image_uploader_container">
										    <p style="text-align:center;"><a class="btn blue" id="pickfiles" href="javascript:;">本地上传</a></p>
										</div>
										
										<br />
										<pre id="console"></pre>
										
										<script type="text/javascript">
										var imageUploader = new ImageUploader();
											$(function()
											{
												$('#image_uploader').draggable();
											})
										</script>
						</div>
				</div><!-- /.modal-content -->
		</div><!-- /.modal-dialog -->
</div><!-- /.modal -->

<!-- 上传图片 /-->
<script>
$(function() {    
    Metronic.init(); // init metronic core components
	Layout.init(); // init current layout
	QuickSidebar.init(); // init quick sidebar
	Demo.init(); // init demo features
	$(".date-picker").datepicker({ 
		rtl: Metronic.isRTL(),
        autoclose: true
    });
});

$("#money").keyup(function(){
	$(this).next().find("span").text($(this).val());
})
//增加TR
var tbody=$("#tbody");
var i=1;
$("#addTr").click(function(){
	var str='';
	str+='<tr data-id='+i+' class="gradeX odd" role="row">';
	str+='<td><input type="text" class="form-control" name="prizename"></td>';
	str+='<td><input type="text" class="form-control up" name="prizeImg"></td>';
	str+='<td><img src="" width="90" height="90"></td>';
	str+='<td><input type="text" class="form-control" name="prizeInfo"></td>';
	str+='<td><input type="text" class="form-control" name="number"></td>';
	str+='<td><a href="javascript:;" class="del_tr btn red">删除</a></td>';
	str+='</tr>';
	tbody.append(str);
	i++;
})
//上传图片回调函数
$(document).on('click',"input.up",function(){
	var _this=$(this);
	$('#image_uploader').modal('show');
	imageUploader.show('position',callback);
	function callback(responseObject)
	{	
		var imgDom=_this.parent().next().find("img");
		json = $.parseJSON(responseObject.response);
		if (json.flag == 'error')
		{
			showMessage(json.msg);
		}
		else if (json.flag == 'success')
		{
			_this.val(json.url);
			imgDom.attr("src",json.url);
		}
	}
})
//删除tr
$(document).on("click",'.del_tr',function(){
	var tr = $(this).closest('tr');
	var id = tr.data('id');
	if (confirm('确定删除？')){
		$.post('url',{id:id},function(data){
			if (data.errno == 0){
				//改变状态
				tr.find('input[type=hidden]').val(2);
				tr.css("display","none");
				return;
			}else{
				alert(data.msg);
			}
		})

	}
})
</script>
<!-- END JAVASCRIPTS -->
</body>
<!-- END BODY -->
</html>
